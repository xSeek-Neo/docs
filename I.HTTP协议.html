<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>http协议 | 葵花寶典</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="../favicon.ico">
    <link rel="manifest" href="../manifest.json">
    <link rel="apple-touch-icon" href="/docs/icons/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/docs/icons/safari-pinned-tab.svg" color="#2486b9">
    <meta name="description" content="业精于勤荒于嬉，行成于思毁于随">
    <meta name="theme-color" content="#ffffff">
    <meta name="author" content="Dendi">
    <meta name="keywords" content="vue面试题 面试题 js面试题 css面试题 React面试题 2025前端面试题">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/docs/assets/css/0.styles.a9377658.css" as="style"><link rel="preload" href="/docs/assets/js/app.087761fe.js" as="script"><link rel="preload" href="/docs/assets/js/2.959c8da4.js" as="script"><link rel="preload" href="/docs/assets/js/1.310dd804.js" as="script"><link rel="preload" href="/docs/assets/js/35.bba5649d.js" as="script"><link rel="preload" href="/docs/assets/js/21.cb775a35.js" as="script"><link rel="prefetch" href="/docs/assets/js/11.b5971ed6.js"><link rel="prefetch" href="/docs/assets/js/12.df494d0c.js"><link rel="prefetch" href="/docs/assets/js/13.ed3696cc.js"><link rel="prefetch" href="/docs/assets/js/14.5a912372.js"><link rel="prefetch" href="/docs/assets/js/15.f5749a7f.js"><link rel="prefetch" href="/docs/assets/js/16.d88a2e4c.js"><link rel="prefetch" href="/docs/assets/js/17.2239bfee.js"><link rel="prefetch" href="/docs/assets/js/18.e92dd762.js"><link rel="prefetch" href="/docs/assets/js/19.6d685711.js"><link rel="prefetch" href="/docs/assets/js/20.740c71f6.js"><link rel="prefetch" href="/docs/assets/js/22.df72b290.js"><link rel="prefetch" href="/docs/assets/js/23.a936b857.js"><link rel="prefetch" href="/docs/assets/js/24.f66c2a95.js"><link rel="prefetch" href="/docs/assets/js/25.182b4ffb.js"><link rel="prefetch" href="/docs/assets/js/26.7543e24f.js"><link rel="prefetch" href="/docs/assets/js/27.fc3633d7.js"><link rel="prefetch" href="/docs/assets/js/28.5f473c5e.js"><link rel="prefetch" href="/docs/assets/js/29.1ceb8156.js"><link rel="prefetch" href="/docs/assets/js/3.940bfe8a.js"><link rel="prefetch" href="/docs/assets/js/30.ff7d69b0.js"><link rel="prefetch" href="/docs/assets/js/31.e2318a1e.js"><link rel="prefetch" href="/docs/assets/js/32.209d1054.js"><link rel="prefetch" href="/docs/assets/js/33.8e11759c.js"><link rel="prefetch" href="/docs/assets/js/34.b7be3ad7.js"><link rel="prefetch" href="/docs/assets/js/36.0d37c7ee.js"><link rel="prefetch" href="/docs/assets/js/37.292a84f5.js"><link rel="prefetch" href="/docs/assets/js/38.2f0c8fb9.js"><link rel="prefetch" href="/docs/assets/js/39.6d8bcb51.js"><link rel="prefetch" href="/docs/assets/js/4.89a06391.js"><link rel="prefetch" href="/docs/assets/js/40.0a22be58.js"><link rel="prefetch" href="/docs/assets/js/41.de49f4c6.js"><link rel="prefetch" href="/docs/assets/js/42.a7376ab9.js"><link rel="prefetch" href="/docs/assets/js/5.55c1efc0.js"><link rel="prefetch" href="/docs/assets/js/6.f8f31b67.js"><link rel="prefetch" href="/docs/assets/js/7.500fab81.js"><link rel="prefetch" href="/docs/assets/js/vendors~docsearch.d9dffa33.js"><link rel="prefetch" href="/docs/assets/js/vendors~flowchart.d7dffb21.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.a9377658.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/logo.png" alt="葵花寶典" class="logo"> <span class="site-name can-hide">葵花寶典</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习资料💾" class="dropdown-title"><span class="title">学习资料💾</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习资料💾" class="mobile-dropdown-title"><span class="title">学习资料💾</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://es6.ruanyifeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ES6 入门教程-阮一峰
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://stackoverflow.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  StackOverFlow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://interview.poetries.top/docs/base.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  未来博客面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><span class="title">面试题</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试题" class="mobile-dropdown-title"><span class="title">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.bookstack.cn/read/CS-Interview-Knowledge-Map/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIT" class="dropdown-title"><span class="title">GIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIT" class="mobile-dropdown-title"><span class="title">GIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/xSeek-Neo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的GITHUB
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/docs/K.GIT.html" class="nav-link">
  GIT常用命令
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习资料💾" class="dropdown-title"><span class="title">学习资料💾</span> <span class="arrow down"></span></button> <button type="button" aria-label="学习资料💾" class="mobile-dropdown-title"><span class="title">学习资料💾</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://es6.ruanyifeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ES6 入门教程-阮一峰
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://stackoverflow.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  StackOverFlow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://interview.poetries.top/docs/base.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  未来博客面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><span class="title">面试题</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试题" class="mobile-dropdown-title"><span class="title">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.bookstack.cn/read/CS-Interview-Knowledge-Map/README.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  面试题
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIT" class="dropdown-title"><span class="title">GIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIT" class="mobile-dropdown-title"><span class="title">GIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/xSeek-Neo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的GITHUB
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/docs/K.GIT.html" class="nav-link">
  GIT常用命令
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/A.HTML5.html" class="sidebar-link">HTML5</a></li><li><a href="/docs/B.CSS3.html" class="sidebar-link">CSS3</a></li><li><a href="/docs/C.ES.html" class="sidebar-link">ES基础进阶</a></li><li><a href="/docs/D.异步并发.html" class="sidebar-link">异步与并发</a></li><li><a href="/docs/E.浏览器相关.html" class="sidebar-link">浏览器相关</a></li><li><a href="/docs/F.框架.VUE.html" class="sidebar-link">VUE</a></li><li><a href="/docs/F.框架.REACT.html" class="sidebar-link">REACT</a></li><li><a href="/docs/F.框架.NEXT.html" class="sidebar-link">NEXT</a></li><li><a href="/docs/G.工程化构建.html" class="sidebar-link">工程化构建</a></li><li><a href="/docs/H.性能优化.html" class="sidebar-link">性能优化</a></li><li><a href="/docs/S.性能监控.html" class="sidebar-link">性能监控SDK</a></li><li><a href="/docs/I.HTTP协议.html" class="active sidebar-link">HTTP协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#http协议" class="sidebar-link">http协议</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#同源策略" class="sidebar-link">同源策略</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#一次完整的http请求所经历的7个步骤" class="sidebar-link">一次完整的HTTP请求所经历的7个步骤</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#web安全-加上原理" class="sidebar-link">Web安全(加上原理)</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#跨域-2" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#dns解析过程" class="sidebar-link">DNS解析过程</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#内存泄漏" class="sidebar-link">内存泄漏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#axios下载文件流处理" class="sidebar-link">Axios下载文件流处理</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#统计pv-uv" class="sidebar-link">统计pv uv</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#重写浏览器的方法-pushstate-和-replacestate" class="sidebar-link">重写浏览器的方法 pushState 和 replaceState</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#监听元素是否在页面中" class="sidebar-link">监听元素是否在页面中</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#get和post有什么区别" class="sidebar-link">get和post有什么区别</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#解释一下什么是json" class="sidebar-link">解释一下什么是json</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#http协议规定的协议头和请求头有什么" class="sidebar-link">HTTP协议规定的协议头和请求头有什么</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#📋-目录" class="sidebar-link">📋 目录</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#🎯-开场白-30秒" class="sidebar-link">🎯 开场白（30秒）</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#💡-核心回答-2-3分钟" class="sidebar-link">💡 核心回答（2-3分钟）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_1-为什么需要心跳检测" class="sidebar-link">1. 为什么需要心跳检测？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_2-实现方案" class="sidebar-link">2. 实现方案</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_3-技术细节" class="sidebar-link">3. 技术细节</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_4-工程实践" class="sidebar-link">4. 工程实践</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#🎤-完整回答示例-3-5分钟" class="sidebar-link">🎤 完整回答示例（3-5分钟）</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#🔍-常见追问及回答" class="sidebar-link">🔍 常见追问及回答</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q1-心跳频率如何选择" class="sidebar-link">Q1: 心跳频率如何选择？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q2-服务器端如何实现" class="sidebar-link">Q2: 服务器端如何实现？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q3-心跳会影响性能吗" class="sidebar-link">Q3: 心跳会影响性能吗？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q4-为什么是-10-秒和-30-秒" class="sidebar-link">Q4: 为什么是 10 秒和 30 秒？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q5-有没有其他方案" class="sidebar-link">Q5: 有没有其他方案？</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#q6-遇到过什么问题" class="sidebar-link">Q6: 遇到过什么问题？</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#✅-回答要点总结" class="sidebar-link">✅ 回答要点总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#回答结构" class="sidebar-link">回答结构</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#回答技巧" class="sidebar-link">回答技巧</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#关键数据" class="sidebar-link">关键数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#📝-代码示例-可选展示" class="sidebar-link">📝 代码示例（可选展示）</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#🎓-进阶知识点-加分项" class="sidebar-link">🎓 进阶知识点（加分项）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_1-心跳协议设计" class="sidebar-link">1. 心跳协议设计</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_2-超时时间计算" class="sidebar-link">2. 超时时间计算</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_3-心跳与重连的联动" class="sidebar-link">3. 心跳与重连的联动</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_4-资源管理" class="sidebar-link">4. 资源管理</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#_5-性能优化" class="sidebar-link">5. 性能优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#📚-相关知识点" class="sidebar-link">📚 相关知识点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#websocket-状态" class="sidebar-link">WebSocket 状态</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#心跳检测时机" class="sidebar-link">心跳检测时机</a></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#最佳实践" class="sidebar-link">最佳实践</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/I.HTTP协议.html#说说tcp为什么需要三次握手和四次挥手" class="sidebar-link">说说TCP为什么需要三次握手和四次挥手</a></li></ul></li><li><a href="/docs/K.综合场景题.html" class="sidebar-link">综合场景题</a></li><li><a href="/docs/L.THIS.html" class="sidebar-link">THIS</a></li><li><a href="/docs/N.DOM.html" class="sidebar-link">DOM</a></li><li><a href="/docs/R.BOM.html" class="sidebar-link">BOM</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="http协议">http协议</h2> <h2 id="同源策略">同源策略</h2> <p>同源策略可防止 JavaScript 发起跨域请求。同源被定义为 URI、主机名和端口号的组合。此策略可防止页面上的恶意脚本通过该页面的文档对象模型，访问另一个网页上的敏感数据。</p> <h2 id="跨域">跨域</h2> <ul><li>原因
浏览器的同源策略导致了跨域</li> <li>作用
用于隔离潜在恶意文件的重要安全机制</li> <li>解决
jsonp ，允许 script 加载第三方资源
反向代理（nginx 服务内部配置 Access-Control-Allow-Origin *）
cors 前后端协作设置请求头部，Access-Control-Allow-Origin 等头部信息
iframe 嵌套通讯，postmessage
三个允许跨域加载资源的标签：img link script</li> <li></li></ul> <p>跨域是可以发送请求，后端也会正常返回结果，只不过这个结果被浏览器拦截了！
*
JSONP
*
CORS
*
websocket
*</p> <h2 id="一次完整的http请求所经历的7个步骤">一次完整的HTTP请求所经历的7个步骤</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>HTTP通信机制是在一次完整的HTTP通信过程中，Web浏览器与Web服务器之间将完成下列7个步骤：

建立TCP连接
在HTTP工作开始之前，Web浏览器首先要通过网络与Web服务器建立连接，该连接是通过TCP来完成的，该协议与IP协议共同构建 Internet，即著名的TCP/IP协议族，因此Internet又被称作是TCP/IP网络。HTTP是比TCP更高层次的应用层协议，根据规则， 只有低层协议建立之后才能，才能进行更层协议的连接，因此，首先要建立TCP连接，一般TCP连接的端口号是80。

Web浏览器向Web服务器发送请求行
一旦建立了TCP连接，Web浏览器就会向Web服务器发送请求命令。例如：GET /sample/hello.jsp HTTP/1.1。

Web浏览器发送请求头
浏览器发送其请求命令之后，还要以头信息的形式向Web服务器发送一些别的信息，之后浏览器发送了一空白行来通知服务器，它已经结束了该头信息的发送。

Web服务器应答
客户机向服务器发出请求后，服务器会客户机回送应答， HTTP/1.1 200 OK ，应答的第一部分是协议的版本号和应答状态码。

Web服务器发送应答头
正如客户端会随同请求发送关于自身的信息一样，服务器也会随同应答向用户发送关于它自己的数据及被请求的文档。

Web服务器向浏览器发送数据
Web服务器向浏览器发送头信息后，它会发送一个空白行来表示头信息的发送到此为结束，接着，它就以Content-Type应答头信息所描述的格式发送用户所请求的实际数据。

Web服务器关闭TCP连接
一般情况下，一旦Web服务器向浏览器发送了请求数据，它就要关闭TCP连接，然后如果浏览器或者服务器在其头信息加入了这行代码：

Connection:keep-alive
TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了网络带宽。

建立TCP连接-&gt;发送请求行-&gt;发送请求头-&gt;（到达服务器）发送状态行-&gt;发送响应头-&gt;发送响应数据-&gt;断TCP连接
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="web安全-加上原理">Web安全(加上原理)</h2> <p>你所了解到的Web攻击技术
（1）XSS（Cross-Site Scripting，跨站脚本攻击）：指通过存在安全漏洞的Web网站注册用户的浏览器内运行非法的HTML标签或者JavaScript进行的一种攻击。
（2）SQL注入攻击
（3）CSRF（Cross-Site Request Forgeries，跨站点请求伪造）：指攻击者通过设置好的陷阱，强制对已完成的认证用户进行非预期的个人信息或设定信息等某些状态更新。</p> <h2 id="跨域-2">跨域</h2> <ul><li>原因
浏览器的同源策略导致了跨域</li> <li>作用
用于隔离潜在恶意文件的重要安全机制</li> <li>解决<div class="custom-block tip"><p class="custom-block-title">解决方案</p> <p>jsonp ，允许 script 加载第三方资源</p></div></li></ul> <p>反向代理（nginx 服务内部配置 Access-Control-Allow-Origin *）</p> <p>cors 前后端协作设置请求头部，Access-Control-Allow-Origin 等头部信息</p> <p>iframe 嵌套通讯，postmessage
:::</p> <h2 id="dns解析过程">DNS解析过程</h2> <p><a href="https://cloud.tencent.com/developer/news/324975" target="_blank" rel="noopener noreferrer">DNS解析过程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="内存泄漏">内存泄漏</h2> <p><a href="http://www.ruanyifeng.com/blog/2017/04/memory-leak.html" target="_blank" rel="noopener noreferrer">内存泄漏<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="axios下载文件流处理">Axios下载文件流处理</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>axios({
  url: ``,
  method: &quot;post&quot;,
  responseType: 'blob',
  data
}).then(res =&gt; {
  if(res.status !== 200) {
    return this.$message.error(res.statusText)
  } else {
    const elink = document.createElement('a'); // 创建一个a标签用于下载
    elink.download = name; // 规定被下载的超链接目标名（文件名）
    elink.style.display = 'none';
    document.body.appendChild(elink);
    elink.click();
    document.body.removeChild(elink);
  }
}).catch(err =&gt; {
  console.log(err)
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="统计pv-uv">统计pv uv</h3> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon" target="_blank" rel="noopener noreferrer">navigator.sendBacon<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 上报埋点数据</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code> <span class="token comment">// Navigator.sendBeacon(url, blob) </span>
 <span class="token comment">// 浏览器tab切换 和 最小化浏览器 或 关闭窗口都是执行下面方法并上报数据</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">'hidden'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> header <span class="token operator">=</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'application/x-www-form-urlencoded'</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Dendi'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">88</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> header<span class="token punctuation">)</span>
        navigator<span class="token punctuation">.</span><span class="token function">sendBeacon</span><span class="token punctuation">(</span><span class="token string">'http://localhost:5200/tracker'</span><span class="token punctuation">,</span> blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="重写浏览器的方法-pushstate-和-replacestate">重写浏览器的方法 pushState 和 replaceState</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">const</span> createHistoryEvent <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> History<span class="token operator">&gt;</span><span class="token punctuation">(</span>type<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> historyEvent <span class="token operator">=</span> history<span class="token punctuation">[</span>type<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 调用原生事件</span>
        <span class="token function">historyEvent</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
        <span class="token comment">// 创建新事件 dispatch事件</span>
        <span class="token keyword">const</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
        window<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'pushState'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">createHistoryEvent</span><span class="token punctuation">(</span><span class="token string">'pushState'</span><span class="token punctuation">)</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">[</span><span class="token string">'replaceState'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">createHistoryEvent</span><span class="token punctuation">(</span><span class="token string">'replaceState'</span><span class="token punctuation">)</span>


<span class="token comment">// 跳转自动上报</span>
<span class="token function">captureEvents</span><span class="token punctuation">(</span>mouseEventList
<span class="token operator">:</span>
<span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    mouseEventList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>event <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'路由跳转上报'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">installTracker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>historyTracker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">captureEvents</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'pushState'</span><span class="token punctuation">,</span> <span class="token string">'replaceState'</span><span class="token punctuation">,</span> <span class="token string">'popstate'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>hashTracker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">captureEvents</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'hashchange'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'hash-pv'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="监听元素是否在页面中">监听元素是否在页面中</h3> <p><a href="'https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API'">intersection Observer</a></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">html,
        body</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0
        <span class="token punctuation">}</span>

        <span class="token selector">ul.main</span> <span class="token punctuation">{</span>
            <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
            <span class="token property">overflow-y</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>

            <span class="token selector">.list-item</span> <span class="token punctuation">{</span>
                <span class="token property">margin</span><span class="token punctuation">:</span> 20px 0<span class="token punctuation">;</span>
                <span class="token property">height</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
                <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
                <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
                <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
                <span class="token property">background-color</span><span class="token punctuation">:</span> antiquewhite<span class="token punctuation">;</span>

                <span class="token selector">.img</span> <span class="token punctuation">{</span>
                    <span class="token property">margin-right</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>ts<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> mainEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.main'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> <span class="token function-variable function">getLiEl</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> liEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
            liEl<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;img class=&quot;img&quot; style=&quot;height: 80px&quot;&gt;&lt;/img&gt;&lt;span&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span&gt;</span><span class="token template-punctuation string">`</span></span>
            liEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">color: red; font-weight: bold; font-size: 24px</span><span class="token template-punctuation string">`</span></span>
            liEl<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'list-item'</span>
            liEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'https://p2.img.cctvpic.com/photoAlbum/page/performance/img/2022/4/1/1648804913581_50.jpg'</span><span class="token punctuation">)</span>
            liEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> fragment<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>liEl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>getLiEl<span class="token punctuation">)</span>
        mainEl<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span>

        <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">root</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.main'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// 预先加载 list-item: 上下margin 20, 本身高度80 = 120px 预先加载5 600px = 120px * 5</span>
            <span class="token literal-property property">rootMargin</span><span class="token operator">:</span> <span class="token string">'0px 0px 600px 0px'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">0.5</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">const</span> <span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">entries<span class="token punctuation">,</span> io</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            entries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>target<span class="token punctuation">,</span> isIntersecting<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> index <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1</span>
                    <span class="token keyword">const</span> imgUri <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> img <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.img'</span><span class="token punctuation">)</span>
                    img<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> imgUri<span class="token punctuation">)</span>
                    target<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
                    target<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
                    <span class="token comment">// 停止观察</span>
                    io<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>

                    <span class="token comment">// 关闭观察器</span>
                    <span class="token comment">// io.disconnect()</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
        <span class="token keyword">const</span> liEls <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'.list-item'</span><span class="token punctuation">)</span>
        <span class="token comment">// 开始监听</span>
        liEls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">li</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br></div></div><h2 id="get和post有什么区别">get和post有什么区别</h2> <ul><li>1.get一般是获取数据，post一般是提交数据</li> <li>2.get参数会放在url上，所以安全性比较差，post是放在body中</li> <li>3.get请求刷新服务器或退回是没有影响的，post请求退回时会重新提交数据</li> <li>4.get请求时会被缓存,post请求不会被缓存</li> <li>5.get请求会被保存在浏览器历史记录中,post不会</li> <li>6.get请求只能进行url编码，post请求支持很多种</li></ul> <h2 id="解释一下什么是json">解释一下什么是json</h2> <ul><li>JSON是一种纯字符串形式的数据，它本身不提供任何方法，适合在网络中进行传输</li> <li>JSON数据存储在.json文件中，也可以把JSON数据以字符串的形式保存在数据库、Cookise中</li> <li>JS提供了JSON.parse() JSON.stringify()</li> <li>什么时候使用json：定义接口；序列化；生成token；配置文件package.json</li></ul> <h2 id="http协议规定的协议头和请求头有什么">HTTP协议规定的协议头和请求头有什么</h2> <ul><li>1.请求头信息：</li></ul> <ul><li>Accept:浏览器告诉服务器所支持的数据类型</li> <li>Host:浏览器告诉服务器我想访问服务器的哪台主机</li> <li>Referer:浏览器告诉服务器我是从哪里来的（防盗链）</li> <li>User-Agent:浏览器类型、版本信息</li> <li>Date:浏览器告诉服务器我是什么时候访问的</li> <li>Connection:连接方式</li> <li>Cookie</li> <li>X-Request-With:请求方式</li></ul> <ul><li>2.响应头信息：</li></ul> <ul><li>Location:这个就是告诉浏览器你要去找谁</li> <li>Server:告诉浏览器服务器的类型</li> <li>Content-Type:告诉浏览器返回的数据类型</li> <li>Refresh:控制了的定时刷新</li></ul> <h1 id="websocket-心跳检测-面试标准答案">WebSocket 心跳检测 - 面试标准答案</h1> <h2 id="📋-目录">📋 目录</h2> <ul><li><a href="#%E5%BC%80%E5%9C%BA%E7%99%BD">开场白</a></li> <li><a href="#%E6%A0%B8%E5%BF%83%E5%9B%9E%E7%AD%94">核心回答</a></li> <li><a href="#%E5%AE%8C%E6%95%B4%E5%9B%9E%E7%AD%94%E7%A4%BA%E4%BE%8B">完整回答示例</a></li> <li><a href="#%E5%B8%B8%E8%A7%81%E8%BF%BD%E9%97%AE%E5%8F%8A%E5%9B%9E%E7%AD%94">常见追问及回答</a></li> <li><a href="#%E5%9B%9E%E7%AD%94%E8%A6%81%E7%82%B9%E6%80%BB%E7%BB%93">回答要点总结</a></li></ul> <hr> <h2 id="🎯-开场白-30秒">🎯 开场白（30秒）</h2> <blockquote><p>&quot;心跳检测是 WebSocket 连接保活和故障检测的机制。我在项目中实现过一套完整的心跳机制，包括定时发送、超时检测和自动重连。&quot;</p></blockquote> <hr> <h2 id="💡-核心回答-2-3分钟">💡 核心回答（2-3分钟）</h2> <h3 id="_1-为什么需要心跳检测">1. 为什么需要心跳检测？</h3> <p><strong>标准答案：</strong>
&quot;主要有三个原因：</p> <ol><li><strong>检测假连接</strong>：网络层断开但应用层未感知，<code>readyState</code> 仍为 <code>OPEN</code>，需要主动探测</li> <li><strong>保持连接活跃</strong>：中间设备（路由器、NAT、防火墙）可能因空闲超时断开长连接</li> <li><strong>及时发现故障</strong>：快速发现问题并触发重连，提升用户体验&quot;</li></ol> <h3 id="_2-实现方案">2. 实现方案</h3> <p><strong>标准答案：</strong>
&quot;我采用 <strong>Ping-Pong 机制</strong>：</p> <ul><li>客户端每 <strong>10 秒</strong>发送 <code>'ping'</code> 字符串</li> <li>服务器收到后响应 <code>'pong'</code> 字符串</li> <li>如果 <strong>30 秒</strong>内没收到 <code>'pong'</code>，判定连接异常并关闭，触发自动重连&quot;</li></ul> <h3 id="_3-技术细节">3. 技术细节</h3> <p><strong>标准答案：</strong>
&quot;实现上用了<strong>两个定时器</strong>：</p> <ul><li><code>setInterval</code>：定时发送 <code>ping</code>（10 秒间隔）</li> <li><code>setTimeout</code>：检测超时（30 秒超时）</li></ul> <p><strong>关键点：</strong></p> <ul><li>每次发送 <code>ping</code> 后重置超时定时器</li> <li>收到 <code>pong</code> 后也重置超时定时器</li> <li>连接关闭时清理所有定时器，避免内存泄漏</li> <li>超时时间设置为发送间隔的 3 倍，避免网络抖动误判&quot;</li></ul> <h3 id="_4-工程实践">4. 工程实践</h3> <p><strong>标准答案：</strong>
&quot;在 <code>onopen</code> 时启动心跳，在 <code>onclose</code> 时停止。超时后关闭连接，触发 <code>onclose</code>，进而触发自动重连。这样形成闭环，确保连接可用性。&quot;</p> <hr> <h2 id="🎤-完整回答示例-3-5分钟">🎤 完整回答示例（3-5分钟）</h2> <p><strong>面试官：</strong> 请介绍一下 WebSocket 的心跳检测机制。</p> <p><strong>你：</strong></p> <blockquote><p>&quot;好的，我来说一下我在项目中实现的心跳检测机制。</p> <p><strong>首先，为什么需要心跳检测？</strong> 主要有三个原因：</p> <ol><li><strong>检测假连接</strong>：网络层断开但应用层未感知</li> <li><strong>保持连接活跃</strong>：防止中间设备因空闲断开</li> <li><strong>及时发现故障</strong>：快速触发重连</li></ol> <p><strong>我的实现方案是 Ping-Pong 机制：</strong></p> <ul><li>客户端每 10 秒发送 <code>'ping'</code> 字符串</li> <li>服务器收到后响应 <code>'pong'</code></li> <li>如果 30 秒内没收到 <code>'pong'</code>，判定连接异常</li></ul> <p><strong>技术实现上，我用了两个定时器：</strong></p> <ul><li><code>setInterval</code>：定时发送 <code>ping</code>（10 秒间隔）</li> <li><code>setTimeout</code>：检测超时（30 秒超时）</li></ul> <p><strong>关键逻辑是：</strong></p> <ul><li>每次发送 <code>ping</code> 后重置超时定时器</li> <li>收到 <code>pong</code> 后也重置超时定时器</li> <li>这样只要连接正常，超时定时器会不断被重置</li> <li>如果连接断开，30 秒后触发超时，关闭连接并触发重连</li></ul> <p><strong>在工程实践上：</strong></p> <ul><li>连接建立时（<code>onopen</code>）启动心跳</li> <li>连接关闭时（<code>onclose</code>）停止心跳并清理定时器</li> <li>超时后关闭连接，触发自动重连机制</li></ul> <p><strong>这个方案的优势是：</strong></p> <ol><li>自动检测，无需人工干预</li> <li>及时响应，30 秒内发现问题</li> <li>资源安全，正确清理定时器</li> <li>与重连机制联动，形成完整的容错体系</li></ol> <p><strong>我在实际项目中还遇到过一些问题，比如：</strong></p> <ul><li><strong>内存泄漏</strong>：忘记清理定时器，后来在 <code>onclose</code> 中统一清理</li> <li><strong>误判</strong>：超时时间设置不合理，后来调整为发送间隔的 3 倍</li> <li><strong>重连风暴</strong>：网络不稳定时频繁重连，后来加入了指数退避和最大重连次数限制</li></ul> <p>这就是我实现的心跳检测机制。&quot;</p></blockquote> <hr> <h2 id="🔍-常见追问及回答">🔍 常见追问及回答</h2> <h3 id="q1-心跳频率如何选择">Q1: 心跳频率如何选择？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;需要平衡实时性和资源消耗：</p> <ul><li><strong>实时性要求高</strong>：可以 5 秒（如股票行情）</li> <li><strong>一般场景</strong>：10-30 秒（如聊天、通知）</li> <li><strong>低频场景</strong>：可以更长（如状态同步）</li></ul> <p>我们选择 10 秒是综合考虑了实时性和服务器压力。&quot;</p></blockquote> <h3 id="q2-服务器端如何实现">Q2: 服务器端如何实现？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;服务器端收到 <code>ping</code> 后立即返回 <code>pong</code>。可以用定时器定期检查客户端是否超时，也可以基于心跳时间戳判断。我们用的是时间戳方式，记录每个连接的最后心跳时间，定期扫描超时的连接并关闭。&quot;</p></blockquote> <h3 id="q3-心跳会影响性能吗">Q3: 心跳会影响性能吗？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;影响很小：</p> <ul><li><code>ping</code>/<code>pong</code> 是短字符串，传输量小（几个字节）</li> <li>定时器开销也很低</li> <li>相比连接断开的代价，心跳成本可忽略</li></ul> <p>实际测试中，1000 个连接的心跳开销不到 1% CPU。&quot;</p></blockquote> <h3 id="q4-为什么是-10-秒和-30-秒">Q4: 为什么是 10 秒和 30 秒？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;这是平衡的结果：</p> <ul><li><strong>10 秒发送间隔</strong>：不会过于频繁，也不会间隔太长</li> <li><strong>30 秒超时</strong>：给网络延迟和服务器处理留出缓冲</li> <li><strong>超时时间 = 发送间隔 × 3</strong>，避免误判</li></ul> <p>实际项目中可以根据业务调整，比如实时性要求高的可以缩短到 5 秒。&quot;</p></blockquote> <h3 id="q5-有没有其他方案">Q5: 有没有其他方案？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;还有几种方案：</p> <ol><li><strong>TCP Keep-Alive</strong>：系统层，但不够灵活</li> <li><strong>应用层心跳</strong>：更可控，我们用的就是这种</li> <li><strong>WebSocket Ping/Pong 帧</strong>：协议层，但浏览器 API 不支持发送 Ping 帧</li></ol> <p>我们选择应用层心跳，因为兼容性好、可控性强。&quot;</p></blockquote> <h3 id="q6-遇到过什么问题">Q6: 遇到过什么问题？</h3> <p><strong>标准答案：</strong></p> <blockquote><p>&quot;遇到过几个问题：</p> <ol><li><strong>内存泄漏</strong>：忘记清理定时器，已修复</li> <li><strong>误判</strong>：超时时间设置不合理，已调整为发送间隔的 3 倍</li> <li><strong>重连风暴</strong>：网络不稳定时频繁重连，已加入指数退避和最大重连次数限制</li> <li><strong>时区问题</strong>：服务器和客户端时区不一致导致时间戳判断错误，后来统一使用 UTC 时间&quot;</li></ol></blockquote> <hr> <h2 id="✅-回答要点总结">✅ 回答要点总结</h2> <h3 id="回答结构">回答结构</h3> <ol><li>✅ <strong>结构清晰</strong>：问题 → 方案 → 实现 → 实践</li> <li>✅ <strong>有数据</strong>：10 秒、30 秒等具体参数</li> <li>✅ <strong>有思考</strong>：为什么这样设计</li> <li>✅ <strong>有经验</strong>：遇到过的问题和解决方案</li> <li>✅ <strong>有深度</strong>：技术细节和工程实践</li></ol> <h3 id="回答技巧">回答技巧</h3> <ul><li>🎯 <strong>先说结论</strong>：直接说明是什么</li> <li>📊 <strong>再说原理</strong>：解释为什么</li> <li>🔧 <strong>最后说实现</strong>：展示怎么做</li> <li>💡 <strong>补充经验</strong>：分享踩过的坑</li></ul> <h3 id="关键数据">关键数据</h3> <ul><li><strong>发送间隔</strong>：10 秒</li> <li><strong>超时时间</strong>：30 秒</li> <li><strong>超时倍数</strong>：发送间隔 × 3</li> <li><strong>最大重连次数</strong>：5 次</li> <li><strong>重连间隔</strong>：3 秒</li></ul> <hr> <h2 id="📝-代码示例-可选展示">📝 代码示例（可选展示）</h2> <p>如果面试官要求看代码，可以展示核心部分：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 启动心跳</span>
<span class="token function">startHeartbeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heartbeatTimer<span class="token punctuation">)</span> <span class="token keyword">return</span>

  <span class="token comment">// 每 10 秒发送一次 ping</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>heartbeatTimer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span>readyState <span class="token operator">===</span> WebSocket<span class="token punctuation">.</span><span class="token constant">OPEN</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'ping'</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetHeartbeatTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 重置超时定时器</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span>
  
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetHeartbeatTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 重置超时定时器</span>
<span class="token function">resetHeartbeatTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heartbeatTimeoutTimer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>heartbeatTimeoutTimer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 30 秒内没收到 pong 就超时</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>heartbeatTimeoutTimer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Heartbeat timeout, closing connection'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 关闭连接，触发重连</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 接收消息时处理 pong</span>
<span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>data <span class="token operator">===</span> <span class="token string">'pong'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetHeartbeatTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 收到 pong，重置超时</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ... 处理其他消息</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><hr> <h2 id="🎓-进阶知识点-加分项">🎓 进阶知识点（加分项）</h2> <h3 id="_1-心跳协议设计">1. 心跳协议设计</h3> <ul><li>使用简单的字符串 <code>'ping'</code>/<code>'pong'</code>，避免 JSON 解析开销</li> <li>也可以使用 JSON 格式，便于扩展（如携带时间戳）</li></ul> <h3 id="_2-超时时间计算">2. 超时时间计算</h3> <ul><li>超时时间 = 发送间隔 × 2-3 倍</li> <li>考虑网络延迟、服务器处理时间、时钟偏差</li></ul> <h3 id="_3-心跳与重连的联动">3. 心跳与重连的联动</h3> <ul><li>心跳超时 → 关闭连接 → 触发 <code>onclose</code> → 自动重连</li> <li>形成完整的容错闭环</li></ul> <h3 id="_4-资源管理">4. 资源管理</h3> <ul><li>连接关闭时清理所有定时器</li> <li>避免内存泄漏和无效的定时器执行</li></ul> <h3 id="_5-性能优化">5. 性能优化</h3> <ul><li>心跳消息尽量小（字符串优于 JSON）</li> <li>批量处理多个连接的心跳</li> <li>使用 Web Worker 处理心跳（可选）</li></ul> <hr> <h2 id="📚-相关知识点">📚 相关知识点</h2> <h3 id="websocket-状态">WebSocket 状态</h3> <ul><li><code>WebSocket.CONNECTING</code> (0) - 连接中</li> <li><code>WebSocket.OPEN</code> (1) - 已连接</li> <li><code>WebSocket.CLOSING</code> (2) - 关闭中</li> <li><code>WebSocket.CLOSED</code> (3) - 已关闭</li></ul> <h3 id="心跳检测时机">心跳检测时机</h3> <ul><li>✅ 连接建立时启动</li> <li>✅ 连接关闭时停止</li> <li>✅ 超时时关闭连接</li></ul> <h3 id="最佳实践">最佳实践</h3> <ol><li>✅ 超时时间 &gt; 发送间隔 × 2</li> <li>✅ 及时清理定时器</li> <li>✅ 与重连机制联动</li> <li>✅ 记录心跳日志（便于排查问题）</li></ol> <hr> <p><strong>最后更新：</strong> 2024年</p> <p><strong>适用场景：</strong> WebSocket 相关面试、技术分享、代码审查</p> <h2 id="说说tcp为什么需要三次握手和四次挥手">说说TCP为什么需要三次握手和四次挥手</h2> <p>https://vue3js.cn/interview/http/handshakes_waves.html#%E4%B8%80%E3%80%81%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">一月 6日 2026, 2:07:00 下午</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/S.性能监控.html" class="prev">
        性能监控SDK
      </a></span> <span class="next"><a href="/docs/K.综合场景题.html">
        综合场景题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/docs/assets/js/app.087761fe.js" defer></script><script src="/docs/assets/js/2.959c8da4.js" defer></script><script src="/docs/assets/js/1.310dd804.js" defer></script><script src="/docs/assets/js/35.bba5649d.js" defer></script><script src="/docs/assets/js/21.cb775a35.js" defer></script>
  </body>
</html>
